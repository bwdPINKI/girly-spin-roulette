<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>girly spin - Fixed Arrow Version</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #ffb6c1, #ff69b4, #ff1493);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .title {
            color: #ff1493;
            font-size: 36px;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-weight: bold;
        }

        .wheel-section {
            position: relative;
            margin: 40px 0;
        }

        .wheel-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto;
        }

        #wheelCanvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 0 0 10px #ff1493, 0 15px 35px rgba(0,0,0,0.3);
        }

        /* –°–¢–†–ï–õ–ö–ê –°–ë–û–ö–£ */
        .pointer {
            position: absolute;
            top: 50%;
            right: -30px;
            transform: translateY(-50%);
            z-index: 10;
            width: 60px;
            height: 60px;
        }

        .pointer-svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }

        .spin-button {
            background: linear-gradient(45deg, #ff1493, #ff69b4);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin: 25px 0;
            box-shadow: 0 10px 25px rgba(255, 20, 147, 0.3);
            transition: all 0.3s ease;
        }

        .spin-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(255, 20, 147, 0.4);
        }

        .spin-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result {
            font-size: 24px;
            color: #ff1493;
            font-weight: bold;
            margin: 25px 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
        }

        .prize-amount {
            font-size: 42px;
            color: #ff1493;
            font-weight: bold;
        }

        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">girly spinüíû</h1>
        
        <div class="wheel-section">
            <div class="wheel-container">
                <!-- –°–¢–†–ï–õ–ö–ê –°–ü–†–ê–í–ê -->
                <div class="pointer">
                    <svg class="pointer-svg" viewBox="0 0 100 100">
                        <path d="M10 50 L80 30 L80 70 Z" fill="#800020" stroke="#000" stroke-width="3"/>
                    </svg>
                </div>
                <canvas id="wheelCanvas" width="400" height="400"></canvas>
            </div>
        </div>

        <button class="spin-button" id="spinButton" onclick="startSpin()">
            –ö—Ä—É—Ç–∏—Ç—å –±–∞—Ä–∞–±–∞–Ω! üí´
        </button>

        <div class="result" id="result">
            –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å! üé∞
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const prizes = ["100 –†–£–ë", "200 –†–£–ë", "300 –†–£–ë", "400 –†–£–ë", "500 –†–£–ë", 
                       "600 –†–£–ë", "700 –†–£–ë", "800 –†–£–ë", "900 –†–£–ë", "1000 –†–£–ë"];
        const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57',
                       '#FF9FF3', '#54A0FF', '#5F27CD', '#00D2D3', '#FF9F43'];
        
        let isSpinning = false;

        // –ü–†–û–°–¢–ê–Ø –û–¢–†–ò–°–û–í–ö–ê
        function drawWheel(rotation = 0) {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2 - 15;
            const segmentAngle = (2 * Math.PI) / prizes.length;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate(rotation);
            ctx.translate(-centerX, -centerY);
            
            for (let i = 0; i < prizes.length; i++) {
                const startAngle = i * segmentAngle;
                const endAngle = (i + 1) * segmentAngle;
                
                // –°–µ–≥–º–µ–Ω—Ç
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = colors[i];
                ctx.fill();
                
                // –ì—Ä–∞–Ω–∏—Ü–∞
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // –¢–µ–∫—Å—Ç (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ)
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + segmentAngle / 2);
                ctx.textAlign = 'right';
                ctx.fillStyle = '#000';
                ctx.font = 'bold 16px Arial';
                ctx.fillText(prizes[i], radius - 25, 5);
                ctx.restore();
            }
            
            // –¶–µ–Ω—Ç—Ä
            ctx.beginPath();
            ctx.arc(centerX, centerY, 25, 0, 2 * Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = '#ff1493';
            ctx.lineWidth = 4;
            ctx.stroke();
            
            ctx.restore();
        }

        // –°–£–ü–ï–†-–ü–†–û–°–¢–ê–Ø –õ–û–ì–ò–ö–ê –í–†–ê–©–ï–ù–ò–Ø
        function startSpin() {
            if (isSpinning) return;
            
            isSpinning = true;
            document.getElementById('spinButton').disabled = true;
            document.getElementById('result').textContent = '–ö—Ä—É—Ç–∏–º... üåÄ';

            // –í–´–ë–ò–†–ê–ï–ú –°–õ–£–ß–ê–ô–ù–´–ô –ü–†–ò–ó
            const winningIndex = Math.floor(Math.random() * prizes.length);
            const segmentAngle = (2 * Math.PI) / prizes.length;
            
            // –°–¢–†–ï–õ–ö–ê –°–ü–†–ê–í–ê (90¬∞) - –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–∑ –¥–æ–ª–∂–µ–Ω –æ–∫–∞–∑–∞—Ç—å—Å—è —Å–ª–µ–≤–∞ (180¬∞)
            // –°–º–µ—â–∞–µ–º –Ω–∞ 3 —Å–µ–≥–º–µ–Ω—Ç–∞ —á—Ç–æ–±—ã –ø—Ä–∏–∑ –æ–∫–∞–∑–∞–ª—Å—è –Ω–∞–ø—Ä–æ—Ç–∏–≤ —Å—Ç—Ä–µ–ª–∫–∏
            const offset = 3;
            const targetIndex = (winningIndex + offset) % prizes.length;
            
            // 5 –ø–æ–ª–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤ + —Ü–µ–ª–µ–≤–æ–π —Å–µ–≥–º–µ–Ω—Ç
            const fullRotations = 5;
            const targetRotation = fullRotations * 2 * Math.PI + (targetIndex * segmentAngle);
            
            const startTime = performance.now();
            const duration = 4000;
            
            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // –ü–ª–∞–≤–Ω–æ–µ –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ
                const easeOut = 1 - Math.pow(1 - progress, 3);
                const currentRotation = easeOut * targetRotation;
                
                drawWheel(currentRotation);
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // –§–ò–ù–ê–õ
                    isSpinning = false;
                    document.getElementById('spinButton').disabled = false;
                    document.getElementById('result').innerHTML = 
                        `üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! <div class="prize-amount">${prizes[winningIndex]}</div>`;
                    
                    createConfetti();
                    
                    if (window.Telegram && Telegram.WebApp) {
                        Telegram.WebApp.sendData(JSON.stringify({
                            prize: prizes[winningIndex],
                            user_id: Telegram.WebApp.initDataUnsafe.user?.id
                        }));
                    }
                }
            }
            
            requestAnimationFrame(animate);
        }

        // –ö–û–ù–§–ï–¢–¢–ò
        function createConfetti() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-20px';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.opacity = '1';
                    document.body.appendChild(confetti);

                    confetti.animate([
                        { transform: 'translateY(0px) rotate(0deg)', opacity: 1 },
                        { transform: `translateY(100vh) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                    ], {
                        duration: 2000 + Math.random() * 2000,
                    }).onfinish = () => confetti.remove();
                }, i * 30);
            }
        }

        // –ó–ê–ü–£–°–ö
        drawWheel();
    </script>
</body>
</html>
